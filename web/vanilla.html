<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Previ</title>
    <link rel="stylesheet" href="global.css" />
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <main>
      <h1>Previ</h1>
      <section id="phone" class="active">
        <h2>Phone</h2>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>

        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>

        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
      </section>

      <section id="auto">
        <h2>Auto Insurance</h2>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>

        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>

        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
      </section>

      <section id="internet">
        <h2>Internet</h2>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>

        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>

        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
      </section>

      <section id="home">
        <h2>Home Insurance</h2>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>

        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>

        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis
          libero officiis voluptate excepturi corrupti debitis quam rem nostrum
          beatae! Vitae earum hic, nostrum esse deleniti autem quos accusantium
          cupiditate eveniet!
        </p>
      </section>
    </main>
    <aside id="widget-container" class="hidden">
      <iframe id="widget" src="http://localhost:8001" frameborder="0"></iframe>
    </aside>

    <script>
      const handleSectionScrolledIntoView = (entries, observer) => {
        entries.forEach(({ isIntersecting, target: section }) => {
          if (isIntersecting) {
            const id = section.getAttribute("id");
            section.classList.add("active");
            const iframe = document.getElementById("widget");
            if (iframe && iframe.contentWindow) {
              iframe.contentWindow.postMessage(id, "*");
            } else {
              console.log("iframe not ready");
            }
          } else {
            section.classList.remove("active");
          }
        });
      };

      const watchSections = () => {
        console.log("watching...");
        const observer = new IntersectionObserver(
          handleSectionScrolledIntoView,
          {
            threshold: [0.5],
          }
        );

        document
          .querySelectorAll("section")
          .forEach((el) => observer.observe(el));

        console.log("watch started");

        document.getElementById("widget-container").classList.remove("hidden");

        console.log("bottom shown");
      };

      setTimeout(() => {
        console.log("start timeout");
        watchSections();
      }, 4000);
    </script>
  </body>
</html>
